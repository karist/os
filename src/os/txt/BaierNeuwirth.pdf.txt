Proceedings_NNS of_IN the_DT 3rd_JJ International_NNP Workshop_NNP on_IN Distributed_NNP Statistical_NNP Computing_NNP (_-LRB- DSC_JJ 2003_CD )_-RRB- March_NNP 20–22_CD ,_, Vienna_NNP ,_, Austria_NNP ISSN_NNP 1609-395X_JJ Kurt_NNP Hornik_NNP ,_, Friedrich_NNP Leisch_NNP &_CC Achim_NNP Zeileis_NNP (eds_VBZ ._. )_-RRB- http_NN ://www.ci.tuwien_NN .ac.at/Conferences/DSC-2003/_. High-Level_JJ Interface_NN Between_IN R_NN and_CC Excel_NNP Thomas_NNP Baier_NNP Erich_NNP Neuwirth_NNP Abstract_NN Spreadsheet_NN programs_NNS in_IN general_JJ and_CC Microsoft_NNP Excel_NNP in_IN particular_JJ imple_NN -_: ment_NN a_DT very_RB special_JJ paradigm_NN of_IN computing_NN :_: automatic_JJ creation_NN of_IN depen-_NNS dency_NN structures_NNS for_IN calculation_NN ,_, and_CC automatic_JJ recalculation_NN when_WRB input_NN val-_NNS ues_VBZ change_NN ._. This_DT is_VBZ rather_RB different_JJ from_IN the_DT usual_JJ model_NN of_IN batch_NN processing_NN underlying_VBG most_RBS statistics_NNS software_NN ,_, e.g_VBG ._. R._NNP Since_IN some_DT time_NN now_RB ,_, a_DT COM_NNP server_NN implementation_NN for_IN R_NN has_VBZ been_VBN avail-_DT able_JJ ._. As_IN a_DT more_JJR recent_JJ development_NN ,_, R_NN can_MD also_RB act_VB as_IN COM_NNP client_NN ,_, using_VBG Excel_NNP as_IN a_DT server_NN ._. So_IN we_PRP can_MD either_RB think_VB of_IN R_NN as_IN an_DT extension_NN of_IN Excel_NNP ,_, or_CC of_IN Excel_NNP as_IN a_DT utility_NN program_NN (_-LRB- and_CC data_NN editor_NN )_-RRB- for_IN R._NNP We_PRP will_MD discuss_VB the_DT differences_NNS between_IN these_DT 2_CD approaches_NNS ,_, and_CC their_PRP$ rela_NN -_: tive_JJ merits_NNS under_IN different_JJ circumstances_NNS ._. This_DT will_MD be_VB done_VBN by_IN showing_VBG exam_NN -_: ples_NNS of_IN applications_NNS implementing_VBG these_DT rather_RB different_JJ models_NNS for_IN statistical_JJ computation_NN ._. Emphasis_NNP will_MD be_VB more_RBR on_IN the_DT philosophy_NN and_CC style_NN of_IN statistical_JJ analysis_NN than_IN on_IN technical_JJ implementation_NN details_NNS ._. 1_CD Introduction_NN R_NN (_-LRB- Ihaka_NNP and_CC Gentleman_NNP ,_, 1996_CD )_-RRB- and_CC Microsoft_NNP r©_NN Excel_NNP (_-LRB- Microsoft_NNP Corporation_NNP (_-LRB- 1999)_CD )_-RRB- have_VBP a_DT very_RB different_JJ user_NN interface_NN concept_NN ._. For_IN Rmost_JJ interaction_NN happens_VBZ through_IN the_DT high-level_JJ R_NN language_NN ,_, whereas_IN Excel_NNP mostly_RB works_VBZ with_IN a_DT direct_JJ manipulation_NN interface_NN ._. In_IN R_NN one_CD works_VBZ with_IN data_NNS objects_NNS (_-LRB- data_NNS frames_NNS ,_, matrices_NNS ,_, single_JJ values_NNS )_-RRB- by_IN naming_VBG them_PRP and_CC referring_VBG to_TO them_PRP by_IN names_NNS in_IN the_DT program_NN ._. The_DT spreadsheet_NN in-_RB terface_NN (_-LRB- as_IN implemented_VBN in_IN Excel_NNP ,_, but_CC also_RB in_IN many_JJ other_JJ spreadsheet_NN programs_NNS like_IN Gnumeric_NNP (_-LRB- GNOME_NNP Foundation_NNP ,_, 2003_CD )_-RRB- or_CC OpenCalc_NNP (_-LRB- OpenCalc_NNP Technical_NNP Team_NNP ,_, 2003_CD )_-RRB- allows_VBZ to_TO refer_VB to_TO data_NNS objects_NNS by_IN gesturing_VBG ,_, or_CC pointing_VBG at_IN them_PRP ._. Quite_RB often_RB ,_, this_DT is_VBZ understood_VBN as_IN a_DT GUI_NN (_-LRB- graphical_JJ user_NN interface_NN )_-RRB- concept_NN ,_, which_WDT ,_, however_RB ,_, is_VBZ New_NNP URL_NNP :_: http_NN ://www.R-project_JJ .org/conferences/DSC-2003/_JJ Proceedings_NNS of_IN DSC_NNP 2003_CD 2_CD not_RB correct_VB ._. The_DT gesturing_VBG spreadsheet_NN interface_NN predates_VBZ graphical_JJ user_NN interfaces_NNS ._. Visicalc_NN (_-LRB- Bricklin_NNP ,_, 1979_CD )_-RRB- ,_, the_DT very_RB first_JJ spreadsheet_NN program_NN ,_, was_VBD a_DT character_NN mode_NN application_NN and_CC already_RB implemented_VBD this_DT approach_NN ._. Combining_VBG R_NN and_CC Excel_NNP brings_VBZ together_RB these_DT two_CD very_RB different_JJ user_NN interface_NN worlds_NNS ,_, and_CC therefore_RB ,_, apart_RB from_IN technical_JJ implementation_NN issues_NNS ,_, one_CD also_RB has_VBZ to_TO be_VB very_RB careful_JJ when_WRB combining_VBG radically_RB different_JJ user_NN interaction_NN concepts_NNS ._. More_JJR information_NN indicating_VBG how_WRB the_DT spreadsheet_NN interface_NN is_VBZ very_RB useful_JJ for_IN statistics_NNS can_MD be_VB found_VBN in_IN Neuwirth_NNP (_-LRB- 2000_CD )_-RRB- ,_, and_CC more_RBR generally_RB in_IN science_NN and_CC engineering_NN applications_NNS can_MD be_VB found_VBN in_IN Filby_NNP (_-LRB- 1997_CD )_-RRB- ,_, especially_RB Neuwirth_RB (_-LRB- 1997_CD )_-RRB- ._. We_PRP implemented_VBD 2_CD different_JJ philosophies_NNS ._. In_IN the_DT first_JJ approach_NN ,_, R_NN is_VBZ embedded_VBN as_IN an_DT extension_NN of_IN Excel_NNP ._. The_DT user_NN stays_VBZ within_IN the_DT spreadsheet_NN interaction_NN model_NN and_CC gets_VBZ additional_JJ functionality_NN provided_VBN by_IN R._NNP One_NNP might_MD say_VB this_DT is_VBZ a_DT statistically_RB enriched_VBN version_NN of_IN Excel_NNP ._. This_DT will_MD be_VB discussed_VBN in_IN section_NN 2._VBD In_IN the_DT second_JJ approach_NN ,_, Excel_NNP functionality_NN is_VBZ made_VBN accessible_JJ from_IN within_IN R._NNP The_DT user_NN enters_VBZ R_NN code_NN and_CC some_DT of_IN the_DT R_NN commands_VBZ start_VB Excel_NNP and_CC allow_VB to_TO enter_VB or_CC edit_VB data_NNS in_IN Excel_NNP ._. Alternatively_RB ,_, results_NNS of_IN statistical_JJ computations_NNS in_IN R_NN are_VBP written_VBN into_IN spreadsheet_NN ranges_NNS ._. One_NN might_MD say_VB that_IN Excel_NNP becomes_VBZ accessible_JJ as_IN a_DT scratch-pad_NN for_IN R_NN data_NN and_CC R_NN output_NN ._. This_DT approach_NN is_VBZ discussed_VBN in_IN section_NN 3._. 2_LS Excel_NNP as_IN the_DT host_NN Extending_VBG the_DT functionality_NN of_IN Excel_NNP usually_RB is_VBZ done_VBN in_IN two_CD different_JJ ways_NNS ._. One_NN can_MD either_RB add_VB new_JJ menus_NNS and_CC menu_NN items_NNS offering_VBG operations_NNS on_IN data_NNS in_IN the_DT spread_NN -_: sheets_NNS ,_, or_CC one_CD can_MD define_VB new_JJ functions_NNS which_WDT can_MD be_VB used_VBN in_IN cell_NN formulas_NNS ._. The_DT important_JJ difference_NN is_VBZ that_IN menu_NN operations_NNS produce_VBP static_JJ output_NN ,_, whereas_IN in-cell_JJ functions_NNS will_MD update_VB automatically_RB when_WRB the_DT input_NN cells_NNS for_IN a_DT formula_NN change_NN ._. For_IN every_DT spreadsheet_NN ,_, Excel_NNP internally_RB builds_VBZ the_DT dependency_NN tree_NN and_CC whenever_WRB a_DT cell_NN is_VBZ changed_VBN ,_, all_DT cells_NNS depending_VBG on_IN this_DT cell_NN will_MD automatically_RB be_VB recalculated_VBN ._. Here_RB is_VBZ an_DT example_NN of_IN the_DT simplest_JJS form_NN of_IN using_VBG R_NN functions_NNS in_IN Excel_NNP (_-LRB- through_IN the_DT RExcel_JJ add-in_NN )_-RRB- :_: RApply_NN (_-LRB- "pchisq"_JJ ,30,1_NN )_-RRB- This_DT formula_NN computes_VBZ the_DT probability_NN function_NN of_IN the_DT chi-squared_JJ distribution_NN for_IN the_DT given_VBN values_NNS ._. In_IN terms_NNS of_IN Excel_NNP ,_, R_NN (_-LRB- or_CC more_RBR specific_JJ :_: R’s_JJ services_NNS )_-RRB- is_VBZ a_DT first-class_JJ object_NN in_IN Excel_NNP ._. This_DT also_RB allows_VBZ the_DT arguments_NNS in_IN a_DT call_NN to_TO RApply_NNP to_TO be_VB references_NNS to_TO cells_NNS ._. Using_VBG this_DT mechanism_NN one_NN can_MD calculate_VB the_DT power_NN of_IN a_DT statistical_JJ test_NN in_IN an_DT Excel_NNP sheet_NN ._. Excel_NNP has_VBZ some_DT statistical_JJ distribution_NN functions_NNS including_VBG the_DT chi-squared_JJ distribution_NN in_IN the_DT Data_NNP Analysis_NNP Toolkit_NNP ,_, but_CC only_RB the_DT central_JJ version_NN ._. Since_IN R_NN has_VBZ the_DT non-central_JJ distribution_NN function_NN the_DT advantage_NN of_IN getting_VBG R_NN to_TO work_VB within_IN Excel_NNP is_VBZ immediate_JJ :_: one_NN can_MD calculate_VB the_DT power_NN of_IN chi-squared_JJ tests_NNS in_IN Excel_NNP ._. The_DT example_NN supplied_VBD with_IN our_PRP$ RExcel_NNP add-in_NN calculates_VBZ the_DT power_NN function_NN of_IN a_DT chi-squared_JJ test_NN for_IN a_DT Roulette_NNP wheel_NN with_IN unequal_JJ probabilities_NNS when_WRB testing_VBG for_IN equal_JJ probabilities_NNS ._. Proceedings_NNS of_IN DSC_NNP 2003_CD 3_CD Excel_NNP gives_VBZ a_DT very_RB convenient_JJ interactive_JJ way_NN of_IN doing_VBG what-if_, analyses_NNS ,_, for_IN example_NN by_IN changing_VBG parameters_NNS of_IN a_DT statistical_JJ model_NN ._. RApply_RB turns_VBZ any_DT R_NN function_NN into_IN an_DT Excel_NNP function_NN ._. Sometimes_RB we_PRP might_MD want_VB to_TO hide_VB the_DT R_NN functions_VBZ completely_RB from_IN the_DT user_NN ._. We_PRP can_MD do_VB this_DT by_IN putting_VBG a_DT VBA_NNP (_-LRB- V_NNP isual_, Basic_NNP for_IN Applications_NNS )_-RRB- wrapper_NN around_IN the_DT call_NN to_TO R._NNP VBA_NNP is_VBZ an_DT abbreviation_NN for_IN the_DT macro_JJ language_NN used_VBN in_IN Excel_NNP (_-LRB- and_CC in_IN general_JJ in_IN all_DT Microsoft_NNP Office_NNP applications_NNS )_-RRB- ._. See_VB Microsoft_NNP Corporation_NNP (_-LRB- 2002_CD )_-RRB- for_IN more_JJR information_NN ._. In_IN our_PRP$ case_NN ,_, we_PRP can_MD define_VB Function_NNP ncchidist(x_RB ,_, deg_free_JJ ,_, noncent_JJ )_-RRB- ncchidist=RApply_RB (_-LRB- "pchisq"_UH ,x_NN ,_, deg_free_NN ,_, noncent_JJ )_-RRB- End_NN Function_NN Function_NN ncchiinv(_NN prob_NN ,_, deg_free_NN ,_, noncent_JJ )_-RRB- ncchiinv=RApply_RB (_-LRB- "qchisq"_UH ,_, prob_NN ,_, deg_free_NN ,_, noncent_JJ )_-RRB- End_NN Function_IN These_DT two_CD functions_NNS can_MD then_RB be_VB used_VBN like_IN any_DT other_JJ Excel_NNP function_NN ,_, and_CC using_VBG this_DT mechanism_NN we_PRP can_MD make_VB any_DT set_NN of_IN R_NN functions_NNS (_-LRB- including_VBG ones_NNS defined_VBN in_IN user_NN code_NN )_-RRB- transparently_RB accessible_JJ in_IN Excel_NNP ._. The_DT software_NN connection_NN between_IN R_NN and_CC Excel_NNP is_VBZ implemented_VBN by_IN making_VBG R_NN a_DT COM_NNP server_NN ._. The_DT COM_NNP server_NN has_VBZ been_VBN described_VBN in_IN Baier_NNP and_CC Neuwirth_NNP (_-LRB- 2001_CD )_-RRB- ._. There_EX are_VBP two_CD different_JJ implementations_NNS of_IN R_NN as_IN a_DT COM_NNP server_NN available_JJ ._. One_CD of_IN them_PRP provides_VBZ R’s_RB functionality_NN as_IN an_DT invisible_JJ service_NN application_NN (_-LRB- comparable_JJ to_TO e.g_VB ._. a_DT database_NN )_-RRB- ,_, whereas_IN the_DT other_JJ implementation_NN allows_VBZ user_NN interaction_NN with_IN R’s_NNP GUI_NNP interface_NN at_IN the_DT same_JJ time_NN as_IN R’s_NNP computational_JJ engine_NN is_VBZ used_VBN by_IN Excel_NNP ._. More_JJR details_NNS on_IN this_DT will_MD be_VB discussed_VBN later_RB ._. Proceedings_NNS of_IN DSC_NNP 2003_CD 4_CD The_DT complete_JJ interface_NN for_IN using_VBG R_NN in_IN spreadsheet_NN functions_NNS called_VBN directly_RB in_IN spreadsheet_NN cells_NNS in_IN Excel_NNP is_VBZ implemented_VBN with_IN the_DT following_JJ functions_NNS :_: Name_NN Description_NN RApply_RB apply_VB an_DT R_NN function_NN to_TO the_DT given_VBN arguments_NNS REval_NN evaluate_VB an_DT R_NN expression_NN given_VBN as_IN a_DT string_NN RVarSet_NN assign_NN an_DT R_NN expression_NN given_VBN as_IN a_DT string_NN to_TO an_DT R_NN vari-_, able_JJ RPut_NN assign_IN a_DT value_NN from_IN an_DT Excel_NNP range_NN to_TO an_DT R_NN variable_JJ RStrPut_NN assign_IN a_DT value_NN from_IN an_DT Excel_NNP range_NN to_TO an_DT R_NN variable_JJ as_IN a_DT string_NN RProc_NN execute_VB some_DT R_NN commands_VBZ RApply_RB and_CC REval_NNP evaluate_VB R_NN function_NN calls_NNS and_CC put_VBD the_DT result_NN in_IN a_DT cell_NN ._. The_DT dif_JJ -_: ference_NN is_VBZ that_IN RApply_NNP expects_VBZ the_DT function_NN as_IN the_DT first_JJ argument_NN and_CC the_DT arguments_NNS for_IN the_DT function_NN as_IN the_DT remaining_VBG arguments_NNS whereas_IN REval_NNP needs_VBZ a_DT string_NN which_WDT is_VBZ a_DT complete_JJ R_NN function_NN call_NN including_VBG the_DT arguments_NNS as_IN its_PRP$ argument_NN ._. Typical_JJ uses_NNS are_VBP RApply_RB (_-LRB- "sin"_JJ ,1_NN )_-RRB- and_CC REval_NNP (_-LRB- "sin(_NN 1_CD )_-RRB- "_`` )_-RRB- ._. In_IN both_DT cases_NNS ,_, all_DT the_DT arguments_NNS can_MD be_VB references_NNS to_TO other_JJ spreadsheet_NN cells_NNS ._. Since_IN RApply_NNP performs_VBZ a_DT function_NN call_NN with_IN a_DT function_NN as_IN the_DT first_JJ argument_NN to_TO RApply_NNP and_CC the_DT arguments_NNS to_TO this_DT function_NN as_IN the_DT remaining_VBG arguments_NNS ,_, and_CC since_IN R_NN is_VBZ a_DT fully_RB functional_JJ language_NN with_IN functions_NNS as_IN first_JJ class_NN objects_NNS ,_, one_NN also_RB can_MD make_VB function_NN calls_NNS like_IN RApply_NNP (_-LRB- "function(_NN x_NN )x*x"_JJ ,2_NN )_-RRB- and_CC again_RB ,_, the_DT arguments_NNS for_IN RApply_NN can_MD be_VB cell_NN references_NNS to_TO other_JJ spreadsheet_NN cells_NNS ._. This_DT is_VBZ how_WRB one_PRP can_MD define_VB an_DT R_NN function_NN on_IN the_DT spot_NN within_IN a_DT spreadsheet_NN ,_, and_CC this_DT can_MD even_RB be_VB an_DT anonymous_JJ function_NN ._. For_IN functions_NNS with_IN more_JJR code_NN ,_, however_RB ,_, being_VBG able_JJ to_TO define_VB named_VBN function_NN is_VBZ quite_RB useful_JJ ._. RProc_NNP takes_VBZ a_DT columnar_JJ spreadsheet_NN range_NN and_CC executes_NNS the_DT text_NN in_IN the_DT range_NN as_IN R_NN code_NN ._. Writing_VBG a_DT function_NN definition_NN in_IN the_DT usual_JJ way_NN myfun_NN <_NNS -_: function(_JJ x_NN )_-RRB- {_VBZ x*x_JJ }_NNS and_CC calling_VBG RProc_NNP with_IN this_DT range_NN as_IN argument_NN will_MD define_VB function_NN myfun_NN in_IN R._NNP Then_RB ,_, RApply_NNP can_MD use_VB myfun_NN as_IN its_PRP$ fist_NN argument_NN ._. RVarSet_NN has_VBZ two_CD arguments_NNS ,_, a_DT variable_JJ name_NN and_CC a_DT string_NN expression_NN ._. The_DT string_NN expression_NN must_MD be_VB a_DT valid_JJ R_NN expression_NN and_CC the_DT value_NN of_IN this_DT expression_NN is_VBZ assigned_VBN to_TO the_DT variable_JJ ._. The_DT string_NN expression_NN can_MD be_VB constructed_VBN by_IN combining_VBG contents_NNS of_IN spreadsheet_NN cells_NNS with_IN Excel’s_NNP string_NN functions_NNS ._. RVarSet(_NN A1,B1&_. "_'' *"&B2_NN )_-RRB- would_MD use_VB R_NN to_TO multiply_VB the_DT contents_NNS of_IN cells_NNS B1_. and_CC B2_JJ in_IN a_DT spreadsheet_NN and_CC assign_NN the_DT result_NN to_TO the_DT variable_NN whose_WP$ name_NN is_VBZ given_VBN in_IN cell_NN A1_NNP ._. Note_VB that_IN in_IN this_DT example_NN VBA’s_IN string_NN concatenation_NN operator_NN &_CC is_VBZ used_VBN to_TO build_VB the_DT string_NN argument_NN ._. RPut_NN and_CC RStrPut_NN assign_NN a_DT value_NN from_IN an_DT Excel_NNP range_NN to_TO an_DT R_NN variable_JJ ._. RPut_NNP will_MD assign_VB a_DT numeric_JJ value_NN if_IN all_PDT the_DT cells_NNS referenced_VBN in_IN the_DT second_JJ argument_NN contain_VBP numeric_JJ values_NNS ,_, RStrPut_NNP will_MD enforce_VB that_IN the_DT assigned_VBN values_NNS in_IN R_NN are_VBP string_NN values_NNS ._. Proceedings_NNS of_IN DSC_NNP 2003_CD 5_CD If_IN the_DT range_NN consists_VBZ of_IN only_RB one_CD cell_NN the_DT assigned_VBN object_NN it_PRP will_MD be_VB a_DT scalar_NN ._. Otherwise_RB the_DT object_NN will_MD either_RB be_VB a_DT numeric_JJ or_CC a_DT string_NN matrix_NN ._. Allowing_'' named_VBN functions_NNS defined_VBN in_IN a_DT spreadsheet_NN cell_NN to_TO be_VB used_VBN in_IN the_DT calcula_NN -_: tions_NNS in_IN other_JJ cells_NNS introduces_VBZ new_JJ problems_NNS :_: dependencies_NNS and_CC recalculation_NN order_NN ._. For_IN every_DT spreadsheet_NN ,_, Excel_NNP has_VBZ a_DT dependency_NN table_NN so_IN when_WRB any_DT cell_NN is_VBZ changed_VBN ,_, it_PRP recalculates_VBZ all_PDT the_DT cells_NNS depending_VBG on_IN this_DT cell_NN ._. If_IN in_IN some_DT cell_NN in_IN our_PRP$ spreadsheet_NN we_PRP use_VBP a_DT function_NN defined_VBN using_VBG RProc_NNP in_IN another_DT cell_NN ,_, Excel_NNP does_VBZ not_RB know_VB that_IN the_DT function_NN definition_NN has_VBZ to_TO be_VB evaluated_VBN before_IN the_DT function_NN is_VBZ evaluated_VBN ._. To_TO solve_VB this_DT problem_NN we_PRP introduce_VBP what_WP we_PRP might_MD call_VB artificial_JJ dependencies_NNS ._. REval_NN ,_, RProc_NNP ,_, RVarSet_NNP ,_, RPut_NNP ,_, and_CC RStrPut_NNP all_DT have_VBP a_DT fixed_JJ number_NN of_IN arguments_NNS for_IN normal_JJ use_NN ._. They_PRP will_MD take_VB additional_JJ arguments_NNS ._. These_DT arguments_NNS will_MD be_VB evaluated_VBN within_IN Excel_NNP before_IN the_DT operation_NN itself_PRP is_VBZ performed_VBN ._. If_IN the_DT first_JJ argument_NN of_IN REval_NNP is_VBZ a_DT function_NN call_NN for_IN an_DT R_NN function_NN defined_VBN in_IN some_DT other_JJ cell(_JJ s_PRP )_-RRB- of_IN the_DT spreadsheet_NN (_-LRB- possibly_RB using_VBG RProc_NNP )_-RRB- ,_, a_DT second_JJ argument_NN to_TO REval_NNP referencing_VBG the_DT cell_NN where_WRB the_DT definition_NN is_VBZ executed_VBN (_-LRB- this_DT is_VBZ the_DT cell_NN with_IN the_DT spreadsheet_NN formula_NN containing_VBG RProc_NNP ,_, not_RB the_DT cell(_JJ s_VBZ )_-RRB- with_IN the_DT code_NN defining_VBG the_DT function_NN )_-RRB- ,_, will_MD enforce_VB that_IN the_DT definition_NN is_VBZ performed_VBN before_IN the_DT function_NN is_VBZ evaluated_VBN ._. This_DT is_VBZ especially_RB important_JJ when_WRB the_DT function_NN definition_NN is_VBZ changed_VBN ._. In_IN that_DT case_NN ,_, without_IN indicating_VBG the_DT dependency_NN ,_, the_DT evaluation_NN call_NN might_MD use_VB an_DT obsolete_JJ definition_NN of_IN a_DT function_NN ._. Things_NNS are_VBP a_DT little_JJ bit_NN more_RBR complicated_JJ for_IN RApply_NNP ._. RApply_NNP takes_VBZ a_DT variable_JJ number_NN of_IN arguments_NNS ._. Therefore_RB ,_, we_PRP need_VBP an_DT indicator_NN to_TO separate_VB real_JJ arguments_NNS (_-LRB- the_DT ones_NNS used_VBN in_IN the_DT R_NN function_NN call_NN )_-RRB- from_IN arguments_NNS used_VBN only_RB to_TO indicate_VB dependencies_NNS ._. If_IN an_DT argument_NN to_TO RApply_NNP is_VBZ the_DT string_NN "depends_VBZ "_`` ,_, then_RB no_DT arguments_NNS to_TO RApply_NNP will_MD be_VB used_VBN in_IN the_DT R_NN function_NN call_NN created_VBN by_IN RApply_NNP ._. Currently_RB ,_, our_PRP$ implementation_NN runs_VBZ reasonably_RB well_RB for_IN the_DT R_NN (_-LRB- D)COM_NNP server_NN described_VBD in_IN Baier_NNP and_CC Neuwirth_NNP (_-LRB- 2001_CD )_-RRB- ._. This_DT way_NN ,_, R_NN is_VBZ embedded_VBN invisibly_RB into_IN a_DT spreadsheet_NN application_NN ._. There_EX is_VBZ no_DT GUI_NN or_CC command_NN line_NN interface_NN to_TO the_DT R_NN instance_NN doing_VBG the_DT computational_JJ work_NN for_IN Excel_NNP ._. The_DT R_NN instance_NN can_MD only_RB be_VB accessed_VBN from_IN within_IN Excel_NNP ._. A_DT second_JJ implementation_NN makes_VBZ it_PRP possible_JJ to_TO access_VB an_DT instance_NN of_IN R_NN in_IN a_DT way_NN that_IN Excel_NNP and_CC a_DT command_NN line_NN or_CC GUI_JJ version_NN of_IN R_NN share_NN name_NN ,_, data_NNS ,_, and_CC code_NN space_NN ._. Access_NN to_TO the_DT R_NN command_NN line_NN is_VBZ provided_VBN at_IN the_DT same_JJ time_NN as_IN to_TO the_DT spreadsheet_NN interface_NN ._. This_DT allows_VBZ to_TO use_VB the_DT strengths_NNS of_IN both_DT office_NN applications_NNS and_CC R_NN side_NN by_IN side_NN on_IN the_DT Windows_NNP platform_NN ._. See_VB Baier_NNP (_-LRB- 2003_CD )_-RRB- for_IN details_NNS of_IN this_DT implementations_NNS ._. Instead_RB of_IN using_VBG spreadsheet_NN functions_NNS as_IN the_DT main_JJ interface_NN between_IN R_NN and_CC Excel_NNP we_PRP can_MD also_RB use_VB VBA_NNP (_-LRB- the_DT programming_NN language_NN embedded_VBN in_IN Excel_NNP )_-RRB- ._. This_DT interface_NN (_-LRB- it_PRP is_VBZ the_DT first_JJ one_CD in_IN our_PRP$ project_NN of_IN combining_VBG R_NN and_CC Excel_NNP )_-RRB- is_VBZ described_VBN in_IN Baier_NNP and_CC Neuwirth_NNP (_-LRB- 2001_CD )_-RRB- ,_, and_CC consists_VBZ of_IN 5_CD VBA_NNP procedures_NNS :_: Name_VB Description_NN RInterface_VB .StartRServer_NN starts_VBZ a_DT new_JJ R_NN server_NN instance_NN RInterface_NNP .StopRServer_NNP stops_VBZ the_DT current_JJ R_NN server_NN instance_NN RInterface_NNP .RRun_NNP executes_NNS a_DT line_NN of_IN R_NN code_NN RInterface_NNP .PutArray_NNP transfers_VBZ an_DT array_NN from_IN Excel_NNP to_TO R_NN RInterface_NNP .GetArray_NNP transfers_VBZ an_DT array_NN from_IN R_NN to_TO Excel_NNP Proceedings_NNP of_IN DSC_NNP 2003_CD 6_CD Using_VBG these_DT VBA_NNP procedures_NNS it_PRP is_VBZ possible_JJ to_TO write_VB VBA_NNP programs_NNS with_IN full_JJ access_NN to_TO R._NNP There_EX is_VBZ a_DT very_RB important_JJ difference_NN between_IN embedding_VBG R_NN into_IN Excel_NNP with_IN spreadsheet_NN functions_NNS and_CC with_IN VBA_NNP procedures_NNS :_: when_WRB the_DT function_NN interface_NN is_VBZ used_VBN the_DT execution_NN of_IN R_NN functions_NNS becomes_VBZ part_NN of_IN Excel’s_NNP automatic_JJ recalculation_NN ._. When_WRB the_DT VBA-procedural_JJ interface_NN is_VBZ used_VBN ,_, only_RB the_DT VBA_NN programs_NNS (_-LRB- possibly_RB triggered_VBN by_IN menu_NN items_NNS and_CC buttons_NNS )_-RRB- start_VBP the_DT execution_NN of_IN R_NN code_NN ._. In_IN the_DT standard_JJ case_NN this_DT means_VBZ that_IN R_NN code_NN is_VBZ only_RB executed_VBN when_WRB the_DT user_NN presses_NNS a_DT button_NN or_CC selects_NNS a_DT menu_NN item_NN ._. Here_RB is_VBZ a_DT short_JJ example_NN Sub_JJ Demo(_NNP )_-RRB- Call_NNP RInterface_NNP .StartRServer_NNP Call_NNP RInterface_NNP .RRun(_NNP "z_NNP <_NNP -_: rnorm(60_NN )_-RRB- "_`` )_-RRB- Call_VB RInterface_NNP .RRun(_JJ "dim(z_NN )_-RRB- <_FW -_: c(_CC 10,6)_JJ "_'' )_-RRB- Call_VB RInterface_NNP .GetArray_NNP ("z"_NNP ,_, Range_NNP (_-LRB- "_`` Sheet1!A19"_JJ )_-RRB- )_-RRB- Call_VB RInterface_NNP .StopRServer_NNP End_NNP Sub_NNP This_DT procedure_NN creates_VBZ a_DT vector_NN of_IN 60_CD random_JJ numbers_NNS ,_, transforms_VBZ the_DT vector_NN into_IN a_DT 10x6_CD matrix_NN and_CC then_RB transfers_VBZ the_DT matrix_NN to_TO an_DT Excel_NNP range_NN ._. It_PRP can_MD be_VB attached_VBN to_TO a_DT button_NN or_CC menu_NN item_NN ,_, and_CC then_RB the_DT user_NN can_MD trigger_VB this_DT operation_NN ,_, effectively_RB creating_VBG a_DT matrix_NN of_IN random_JJ numbers_NNS produced_VBN by_IN R_NN in_IN Excel_NNP ._. 3_CD R_NN as_IN the_DT host_NN The_DT other_JJ way_NN of_IN embedding_VBG is_VBZ using_VBG R_NN as_IN the_DT COM_NNP client_NN and_CC ,_, say_VBP ,_, Excel_NNP as_IN the_DT COM_NNP server_NN ._. In_IN this_DT case_NN ,_, “R_NNP is_VBZ in_IN control”_NN ,_, meaning_VBG that_IN the_DT user_NN mainly_RB interacts_VBZ with_IN the_DT R_NN command_NN line_NN ._. A_DT relatively_RB straightforward_JJ use_NN would_MD be_VB calling_VBG Excel_NNP from_IN R_NN to_TO obtain_VB data_NNS already_RB available_JJ as_IN an_DT Excel_NNP spreadsheet_NN ,_, then_RB doing_VBG complex_JJ statistical_JJ analyses_NNS ,_, and_CC finally_RB putting_VBG some_DT reports_NNS (_-LRB- possibly_RB including_VBG graphics_NNS )_-RRB- back_RB into_IN Excel_NNP ._. In_IN theory_NN ,_, this_DT can_MD also_RB be_VB done_VBN using_VBG our_PRP$ previously_RB described_VBN case_NN where_WRB R_NN acts_VBZ as_IN COM_NNP server_NN ._. The_DT main_JJ difference_NN is_VBZ that_IN in_IN the_DT first_JJ framework_NN the_DT user_NN works_VBZ with_IN Excel_NNP enhanced_VBN by_IN R,_NNP and_CC in_IN the_DT second_JJ case_NN works_VBZ with_IN R_NN with_IN the_DT additional_JJ possibility_NN of_IN accessing_VBG Excel_NNP from_IN within_IN R._NNP Excel_NNP ,_, in_IN this_DT case_NN ,_, just_RB is_VBZ a_DT representative_NN for_IN any_DT application_NN exposing_VBG its_PRP$ functionality_NN as_IN a_DT COM_NNP server_NN ._. In_IN particular_JJ ,_, this_DT applies_VBZ to_TO all_DT applications_NNS in_IN Microsoft’s_NNP Office_NNP family_NN of_IN products_NNS ._. In_IN our_PRP$ discussion_NN ,_, R_NN is_VBZ responsible_JJ for_IN the_DT computational_JJ functionality_NN ,_, while_IN the_DT Office_NNP suite_NN is_VBZ used_VBN for_IN user_NN input_NN and_CC out-_NNS put/presentation_NN ._. Using_VBG R’s_NNP COM_NNP client_NN package_NN rcom_NN ,_, one_PRP can_MD access_VB any_DT COM_NNP server’s_NNS functions_NNS as_RB long_RB as_IN they_PRP are_VBP provided_VBN in_IN a_DT form_NN conforming_VBG to_TO OLE_NNP automation_NN ._. In_IN addition_NN to_TO this_DT low-level_JJ mechanism_NN ,_, we_PRP are_VBP providing_VBG the_DT R_NN package_NN ROffice_NNP .Excel_NNP ._. The_DT purpose_NN of_IN this_DT package_NN is_VBZ to_TO allow_VB easy_JJ interaction_NN between_IN R_NN and_CC Microsoft_NNP Excel_NNP ._. It_PRP will_MD simplify_VB the_DT most_RBS common_JJ applications_NNS by_IN providing_VBG high-level_JJ functionality_NN especially_RB designed_VBN as_IN an_DT interface_NN to_TO Excel_NNP ,_, while_IN still_RB providing_VBG full_JJ access_NN to_TO all_DT functionality_NN ._. Proceedings_NNS of_IN DSC_NNP 2003_CD 7_CD We_PRP may_MD enhance_VB R’s_NNS programmable_JJ GUI_NNP available_JJ under_IN Windows_NNP by_IN adding_VBG additional_JJ menu_NN items_NNS ._. These_DT can_MD be_VB used_VBN for_IN easy_JJ integration_NN of_IN foreign_JJ function_NN -_: ality_NN into_IN R’s_NNP more_RBR text-based_JJ interface_NN ._. As_IN an_DT example_NN ,_, basic_JJ integration_NN of_IN part_NN of_IN the_DT Microsoft_NNP Office_NNP suite_NN is_VBZ shown_VBN ._. Excel_NNP functionality_NN can_MD be_VB implemented_VBN in_IN R_NN rather_RB smoothly_RB by_IN adding_VBG menu_NN functions_NNS for_IN transferring_NN data_NNS ._. For_IN this_DT reason_NN ,_, only_RB the_DT integration_NN of_IN Microsoft_NNP Excel_NNP is_VBZ discussed_VBN in_IN more_JJR detail_NN for_IN this_DT part_NN by_IN utilizing_VBG the_DT ROffice_NNP .Excel_NNP high_JJ level_NN access_NN package_NN ._. 3.1_CD Accessing_NNP Excel_NNP ,_, PowerPoint_NNP and_CC Word_NNP Even_RB when_WRB using_VBG R_NN as_IN the_DT primary_JJ workbench_NN for_IN data_NNS analysis_NN ,_, in_IN the_DT Windows_NNP world_NN presentations_NNS of_IN output_NN are_VBP expected_VBN to_TO be_VB done_VBN using_VBG Microsoft’s_NNP Office_NNP suite_NN of_IN programs_NNS ._. At_IN the_DT same_JJ time_NN ,_, many_JJ times_NNS input_NN data_NNS for_IN computations_NNS is_VBZ available_JJ in_IN e.g_NN ._. Microsoft_NNP Excel_NNP file_NN format_NN ._. Sometimes_RB it_PRP can_MD be_VB convenient_JJ to_TO drive_VB PowerPoint_NNP or_CC Word_NNP from_IN the_DT R_NN com-_, mand_VB line_NN or_CC get_VB data_NNS from_IN an_DT Excel_NNP spreadsheet_NN ._. As_IN all_DT Office_NNP applications_NNS expose_VBP their_PRP$ functionality_NN as_IN an_DT object_NN model_NN via_IN COM_NNP ,_, the_DT rcom_NN package_NN can_MD be_VB used_VBN for_IN access_NN ._. The_DT following_VBG code_NN shows_VBZ some_DT R_NN functions_VBZ to_TO start_VB up_RP and_CC show_VB PowerPoint_NNP and_CC Word_NNP :_: .ppoint_NN Handle_VB <_JJ -_: local(_JJ {_NN .pp.loc_NN <_NNS -_: character(_NN 0_CD )_-RRB- function(new_NN )_-RRB- {_VBZ if(_JJ !missing(new_JJ )_-RRB- )_-RRB- {_, .pp.loc_NNP <<_NNP -_: NULL_NN }_NN else_RB {_VBD .pp.loc_NN }_IN }_JJ }_NN )_-RRB- ppointCreate_NN <_NNS -_: function(storeglobal_JJ =_SYM TRUE)_JJ {_NN pp_RP <_FW -_: comCreateObject_NN (_-LRB- "_`` PowerPoint.Application_NN "_'' )_-RRB- if(storeglobal_JJ )_-RRB- {_, .ppoint_JJ Handle(pp_NNP )_-RRB- }_JJ return(pp_NN )_-RRB- }_VBZ ppointGet_JJ <_NNS -_: function(_NN createonerror=TRUE_NN ,_, storeglobal=TRUE,useexisting=TRUE)_NNS {_VBP if(useexisting_VBG &&_NNS !identical(_IN .ppoint_JJ Handle(_NN )_-RRB- ,NULL)_NN )_-RRB- {_VBZ return(_VBG .ppoint_JJ Handle(_JJ )_-RRB- )_-RRB- }_VBZ pp_RP <_FW -_: comGetObject_NN (_-LRB- "_`` PowerPoint.Application_NN "_'' )_-RRB- if(_VBZ createonerror_JJ &&_JJ identical(pp,NULL)_NN )_-RRB- {_VBZ pp_RP <_FW -_: ppointCreate(storeglobal_JJ =_SYM FALSE_NNP )_-RRB- Proceedings_NNP of_IN DSC_NNP 2003_CD 8_CD }_JJ if(storeglobal_JJ )_-RRB- {_NN .ppoint_JJ Handle(pp_NNP )_-RRB- }_JJ return(pp_NN )_-RRB- }_, ppointShow_VB <_VB -_: function(visible=TRUE,pp=ppointGet(_NN )_-RRB- )_-RRB- {_, comSetProperty(pp_NN ,_, "Visible"_JJ ,visible_JJ )_-RRB- }_JJ .word_NN Handle_VB <_JJ -_: local(_JJ {_NN .word_NN .loc_NN <_NNS -_: character(_NN 0_CD )_-RRB- function(new_NN )_-RRB- {_VBZ if(_JJ !missing(new_JJ )_-RRB- )_-RRB- {_, .word_NNP .loc_NNP <<_NNP -_: NULL_NN }_NN else_RB {_VBD .word_NN .loc_NN }_IN }_JJ }_NN )_-RRB- wordCreate_NN <_NNS -_: function(storeglobal_JJ =_SYM TRUE)_JJ {_NN w_WRB <_FW -_: comCreateObject_NN (_-LRB- "_`` Word.Application_NN "_'' )_-RRB- if(storeglobal_JJ )_-RRB- {_JJ .word_NN Handle(_JJ w_NN )_-RRB- }_VBZ return(_JJ w_NN )_-RRB- }_VBZ wordGet_VB <_CD -_: function(_NN createonerror=TRUE_NN ,_, storeglobal=TRUE,useexisting=TRUE)_NN {_NN if(useexisting_VBG &&_JJ !identical(_NN .word_NN Handle(_NN )_-RRB- ,NULL)_NN )_-RRB- {_VBZ return(_VBG .word_NN Handle(_NN )_-RRB- )_-RRB- }_VBZ w_JJ <_NNS -_: comGetObject_NN (_-LRB- "_`` Word.Application_NN "_'' )_-RRB- if(_VBZ createonerror_JJ &&_JJ identical(w,NULL)_NN )_-RRB- {_VBZ w_WRB <_FW -_: ppointCreate(storeglobal_JJ =_SYM FALSE_JJ )_-RRB- }_JJ if(storeglobal_JJ )_-RRB- {_JJ .word_NN Handle(_JJ w_NN )_-RRB- }_JJ return(pp_NN )_-RRB- }_VBZ wordShow_VB <_CD -_: function(visible=TRUE,w=wordGet(_NN )_-RRB- )_-RRB- {_, comSetProperty(w_JJ ,_, "Visible"_JJ ,visible_JJ )_-RRB- }_. To_TO provide_VB some_DT basic_JJ integration_NN into_IN R’s_NNP user_NN interface_NN one_NN can_MD use_VB the_DT functions_NNS winMenuAdd(_NN )_-RRB- and_CC winMenuAddItem(_NN )_-RRB- to_TO add_VB new_JJ menu_NN items_NNS to_TO R’s_NNP GUI._NNP Proceedings_NNP of_IN DSC_NNP 2003_CD 9_CD Adding_VBG a_DT new_JJ pull-down_NN menu_NN Office_NNP with_IN menu_NN items_NNS for_IN starting_VBG Excel_NNP ,_, Pow-_NNP erPoint_NN and_CC Word_NNP is_VBZ achieved_VBN by_IN the_DT following_JJ code_NN :_: winMenuAdd(_VB "_`` Office_NNP "_'' )_-RRB- winMenuAddItem_NN (_-LRB- "_`` Office"_NNP ,"Start_NNP Excel"_NNP ,_, "excelShow(_NN )_-RRB- "_`` )_-RRB- winMenuAddItem_NN (_-LRB- "_`` Office"_NNS ,"Start_VBP PowerPoint"_JJ ,"ppointShow(_NNS )_-RRB- "_`` )_-RRB- winMenuAddItem_NN (_-LRB- "_`` Office"_NNS ,"Start_VBP Word"_JJ ,"wordShow(_NNS )_-RRB- "_`` )_-RRB- As_RB well_RB as_IN starting_VBG these_DT applications_NNS and_CC manipulating_VBG properties_NNS it_PRP is_VBZ easy_JJ as_RB well_RB to_TO call_VB functionality_NN and_CC transfer_NN data_NN between_IN R_NN and_CC Office_NNP ._. 3.2_CD Controlling_NNP Excel_NNP :_: ROffice_NNP .Excel_NNP The_DT object_NN model_NN of_IN many_JJ applications_NNS is_VBZ very_RB complex_JJ and_CC requires_VBZ the_DT user_NN to_TO extensively_RB study_VB help_NN files_NNS and_CC manuals_NNS ._. For_IN many_JJ cases_NNS ,_, only_RB a_DT small_JJ subset_NN of_IN all_DT functionality_NN is_VBZ required_VBN ._. The_DT 90_CD :10_CD rule_NN also_RB applies_VBZ to_TO the_DT requirements_NNS of_IN users_NNS and_CC their_PRP$ applications_NNS :_: 90_CD %_NN of_IN your_PRP$ needs_NNS are_VBP covered_VBN by_IN only_RB 10_CD %_NN of_IN the_DT functionality_NN ._. For_IN our_PRP$ previous_JJ work_NN we_PRP have_VBP been_VBN focusing_VBG on_IN Microsoft_NNP Excel_NNP as_IN a_DT very_RB useful_JJ medium_NN for_IN data_NNS entry_NN and_CC output_NN ._. Therefore_RB ,_, we_PRP decided_VBD to_TO provide_VB an_DT easy-to-use_JJ interface_NN to_TO a_DT small_JJ subset_NN of_IN functions_NNS in_IN Excel_NNP which_WDT can_MD easily_RB be_VB integrated_VBN into_IN the_DT R_NN GUI_NN and_CC R_NN programs_NNS ._. What_WP we_PRP have_VBP been_VBN focusing_VBG on_IN is_VBZ providing_VBG access_NN to_TO •_VB getting_VBG access_NN to_TO Excel_NNP itself_PRP (either_VBZ a_DT current_JJ instance_NN or_CC starting_VBG a_DT new_JJ window_NN )_-RRB- •_, exchanging_VBG Excel’s_NNS current_JJ selection_NN with_IN R_NN (_-LRB- reading_VBG the_DT selection_NN into_IN an_DT R_NN variable_JJ or_CC writing_VBG a_DT variable_JJ to_TO the_DT current_JJ selection_NN )_-RRB- •_VBZ exchange_VB any_DT rectangular_JJ area_NN in_IN the_DT spreadsheet_NN with_IN R_NN In_IN the_DT case_NN of_IN data_NNS transfer_NN ,_, the_DT functions_NNS are_VBP trimmed_VBN to_TO either_DT return_NN a_DT value_NN (_-LRB- e_NN .g_NN ._. a_DT data_NN vector_NN or_CC matrix_NN )_-RRB- or_CC to_TO provide_VB access_NN to_TO the_DT Excel_NNP COM_NNP object_NN itself_PRP ._. The_DT following_VBG functions_NNS have_VBP been_VBN implemented_VBN :_: Name_VB Description_NN excelGet_JJ ,_, excelCreate_JJ return_NN the_DT current_JJ instance_NN of_IN Microsoft_NNP Excel_NNP or_CC create_VB a_DT new_JJ instance_NN excelShow_NN show_VBP the_DT Excel_NNP window_NN excelGetSelectionValue_NN get_VBP selection_NN value_NN excelSetSelectionValue_JJ set_NN selection_NN value_NN excelGetSelection_IN get_VBP selection_NN object_NN excelGetCellValue_JJ get_VBP cell_NN value_NN excelSetCellValue_NN set_VBN cell_NN value_NN excelGetCell_RB get_VB cell_NN object_NN excelGetRangeValue_JJ get_VBP range_NN value_NN excelSetRangeValue_NN set_VBN range_NN value_NN excelGetRange_IN get_VBP range_NN object_NN Proceedings_NNS of_IN DSC_NNP 2003_CD 10_CD Using_VBG these_DT functions_NNS ,_, you_PRP can_MD easily_RB transfer_VB data_NNS between_IN R_NN and_CC Excel_NNP ._. The_DT following_VBG example_NN shows_VBZ how_WRB to_TO store_VB the_DT specified_JJ cell_NN range_NN into_IN R’s_NNP variable_JJ rng1_CD ._. #_# #_# get_VB range_NN "_'' A1_IN "_`` to_TO "_`` D7"_VB and_CC store_VB the_DT matrix_NN into_IN rng1_CD rng1_CD <_NNS -_: excelGetRangeValue_JJ ("_JJ A1:D7"_NN )_-RRB- #_# #_# add_VB 5_CD to_TO every_DT element_NN and_CC store_NN back_RB excelSetRangeValue_JJ ("_NN A1:D7"_JJ ,rng1+5_NN )_-RRB- In_IN the_DT above_JJ example_NN ,_, the_DT currently_RB active_JJ instance_NN of_IN Excel_NNP is_VBZ used_VBN automati-_NNS cally_RB ._. If_IN none_NN is_VBZ running_VBG ,_, Excel_NNP is_VBZ started_VBN and_CC the_DT new_JJ Excel_NNP object_NN is_VBZ returned_VBN (_-LRB- see_VB documentation_NN for_IN excelGet(_NN )_-RRB- and_CC excelGetRangeValue(_JJ )_-RRB- for_IN more_JJR information_NN )_-RRB- ._. Using_VBG the_DT COM_NNP client_NN package_NN R_NN can_MD control_VB the_DT Microsoft’s_NNP Office_NNP suite_NN of_IN ap_NN -_: plications_NNS ._. For_IN easy_JJ access_NN to_TO Excel’s_NNP basic_JJ input_NN and_CC output_NN facilities_NNS the_DT additional_JJ package_NN ROffice_NN .Excel_NNP can_MD be_VB used_VBN ._. For_IN the_DT not_RB so_RB common_JJ operations_NNS ,_, one_CD hsa_NN to_TO rely_VB on_IN rcom_NN and_CC directly_RB access_VB the_DT COM_NN interfaces_VBZ provided_VBN by_IN Excel_NNP ._. The_DT COM_NNP level_NN is_VBZ also_RB the_DT interface_NN currently_RB supported_VBN for_IN the_DT other_JJ applications_NNS of_IN the_DT Office_NNP suite_NN ._. As_IN ROffice_NNP .Excel_NNP builds_VBZ on_IN the_DT low-level_JJ functionality_NN provided_VBN by_IN rcom_NNP and_CC is_VBZ completely_RB written_VBN in_IN R_NN itself_PRP ,_, one_PRP can_MD easily_RB extend_VB the_DT package_NN or_CC seamlessly_RB integrate_VB similar_JJ functionality_NN for_IN other_JJ applications_NNS ._. In_IN the_DT next_JJ section_NN ,_, we_PRP will_MD provide_VB an_DT example_NN giving_VBG a_DT better_JJR idea_NN of_IN the_DT wide_JJ range_NN of_IN applications_NNS of_IN R’s_DT office_NN integration_NN ._. 3.3_CD Excel_NNP →_VBD R_NN →_IN PowerPoint_NNP Office_NNP integration_NN not_RB only_RB means_VBZ that_IN R_NN can_MD get_VB data_NNS from_IN Microsoft_NNP Excel_NNP or_CC pop_VB up_RP another_DT application_NN ._. In_IN fact_NN ,_, R_NN can_MD completely_RB control_VB any_DT of_IN the_DT Office_NNP applications—at_NN least_JJS as_RB far_RB as_IN Office_NNP allows_VBZ this_DT ._. In_IN a_DT very_RB simple_JJ example_NN we_PRP will_MD show_VB how_WRB to_TO use_VB Excel_NNP as_IN a_DT medium_NN for_IN user_NN input_NN and_CC PowerPoint_NN to_TO show_VB the_DT results_NNS of_IN the_DT computations_NNS done_VBN in_IN R._NNP The_DT simple_JJ application_NN will_MD use_VB the_DT χ2_NN goodness-of-fit_JJ test_NN to_TO compute_VB the_DT prob_NN -_: ability_NN of_IN finding_VBG out_RP whether_IN a_DT given_VBN roulette_NN table_NN has_VBZ been_VBN manipulated_VBN ._. We_PRP will_MD use_VB R_NN to_TO do_VB the_DT computations_NNS and_CC show_VB the_DT correlation_NN between_IN the_DT number_NN of_IN observations_NNS and_CC the_DT probability_NN of_IN discovery_NN in_IN a_DT PowerPoint_NN slide_NN ._. Here_RB ,_, R_NN will_MD read_VB the_DT selection_NN from_IN Excel_NNP ._. For_IN the_DT example_NN the_DT selection_NN is_VBZ a_DT matrix_NN with_IN two_CD columns_NNS and_CC 37_CD rows_NNS ,_, the_DT first_JJ column_NN representing_VBG probabilities_NNS of_IN the_DT numbers_NNS 0_VBP to_TO 36_CD for_IN a_DT fair_JJ roulette_NN table_NN ._. The_DT second_NN column_NN represents_VBZ the_DT probabilities_NNS for_IN the_DT manipulated_JJ roulette_NN ._. We_PRP will_MD use_VB some_DT simple_JJ functions_NNS for_IN the_DT computations_NNS ._. The_DT helper_NN functions_NNS are_VBP designed_VBN to_TO handle_VB different_JJ cases_NNS e.g_, ._. various_JJ numbers_NNS of_IN numbers_NNS with_IN equal_JJ probabilities_NNS and_CC manipulated_JJ numbers_NNS ._. noncent_JJ <_FW -_: function(_VBD n_RB ,equal_JJ ,manipulated_CC )_-RRB- {_NN return(_VBD n_RB *_JJ sum(_NN (_-LRB- (_-LRB- manipulated_VBN -_: equal_JJ )_-RRB- **_NN 2_CD )_-RRB- /_NN equal_JJ )_-RRB- )_-RRB- }_VBP Proceedings_NNS of_IN DSC_NNP 2003_CD 11_CD power_NN <_NNS -_: function(_VBD n_RB ,equal_JJ ,manipulated_CC ,dof_JJ ,alpha_NN )_-RRB- {_, nc_NN <_NNS -_: noncent(_JJ n_NN ,equal_JJ ,manipulated_VBD )_-RRB- crit_NN <_NNS -_: qchisq(alpha,dof,0_NN )_-RRB- return(_NN 1_CD -_: pchisq(_NN crit_NN ,dof_IN ,nc_NN )_-RRB- )_-RRB- }_VBZ doTest_JJ <_NNS -_: function(alpha_NN ,report_NN )_-RRB- {_NN selection_NN <_IN -_: excelGetSelectionValue(_NNS )_-RRB- observations_NNS <_VBD -_: c(_NN 100,200,500,1000,2000,5000,10000_CD ,_, 20000,50000,100000,200000,500000,1000000_CD )_-RRB- probabilities_NNS <_VBP -_: power(observations_NNS ,selection[_, ,1]_JJ ,selection[_NN ,2]_NN ,_, 36,alpha_NN )_-RRB- eval(_VBZ call(_JJ report_NN ,observations_NNS ,probabilities_NNS )_-RRB- )_-RRB- }_VBZ The_DT front-end_NN for_IN the_DT application_NN code_NN is_VBZ do_VB Test_NNP ._. This_DT function_NN takes_VBZ the_DT α_JJ value_NN and_CC a_DT reporting_NN function_NN as_IN its_PRP$ arguments_NNS ._. As_IN a_DT reporting_VBG function_NN ,_, one_PRP can_MD e.g._FW ,_, use_VB the_DT plot(_NN )_-RRB- function_NN ._. Now_RB the_DT functionality_NN is_VBZ added_VBN to_TO R’s_NNP main_JJ menu_NN in_IN the_DT R_NN GUI_NN for_IN different_JJ α_NN values_NNS :_: winMenuAdd("_NN Chi-Squared_CC Test_JJ "_'' )_-RRB- winMenuAddItem_NN ("_NN Chi-Squared_JJ Test"_NNP ,_, "alpha_NNP =_SYM 0.75"_CD ,_, "doTest(0.75_CD ,\"plot_NN \"_JJ )"_NN )_-RRB- winMenuAddItem_NN ("_NN Chi-Squared_JJ Test"_NNP ,_, "alpha_NNP =_SYM 0.80"_CD ,_, "doTest(0.80_CD ,\"plot_NN \"_JJ )"_NN )_-RRB- winMenuAddItem_NN ("_NN Chi-Squared_JJ Test"_NNP ,_, "alpha_NNP =_SYM 0.85"_CD ,_, "doTest(0.85_CD ,\"plot_NN \"_JJ )"_NN )_-RRB- winMenuAddItem_NN ("_NN Chi-Squared_JJ Test"_NNP ,_, "alpha_NNP =_SYM 0.90"_CD ,_, "doTest(0.90_CD ,\"plot_NN \"_JJ )"_NN )_-RRB- winMenuAddItem_NN ("_NN Chi-Squared_JJ Test"_NNP ,_, "alpha_NNP =_SYM 0.95"_CD ,_, "doTest(0.95_CD ,\"plot_NN \"_JJ )"_NN )_-RRB- winMenuAddItem_NN ("_NN Chi-Squared_JJ Test"_NNP ,_, "alpha_NNP =_SYM 0.97"_CD ,_, "doTest(0.97_CD ,\"plot_NN \"_JJ )"_NN )_-RRB- do_VBP Test(_JJ )_-RRB- is_VBZ passed_VBN a_DT reporting_VBG function_NN presenting_VBG the_DT results_NNS ._. In_IN addition_NN to_TO the_DT simple_JJ plot(_NN )_-RRB- function_NN used_VBN before_IN ,_, one_PRP can_MD also_RB use_VB some_DT more_RBR sophisticated_JJ output_NN device_NN ._. The_DT following_VBG example_NN will_MD use_VB Microsoft_NNP PowerPoint_NNP as_IN an_DT output_NN device_NN ._. A_DT report_NN function_NN compatible_JJ with_IN the_DT above_JJ argument_NN list_NN is_VBZ shown_VBN below_IN :_: ppointReport_VB <_JJ -_: function(_VBD n_NN ,probs_NNS )_-RRB- {_RB #_# start_VB PowerPoint_NNP and_CC create_VB an_DT presentation_NN with_IN a_DT single_JJ slide_NN ppt_NN <_NN -_: comCreateObject_NN (_-LRB- "_`` PowerPoint.Application_NN "_'' )_-RRB- pres_VBZ <_JJ -_: comInvoke(_JJ comGetProperty(ppt_NN ,"Presentations_NNS "_'' )_-RRB- ,"Add_JJ "_'' )_-RRB- slides_VBZ <_JJ -_: comGetProperty(_JJ pres_NNS ,_, "Slides_NNS "_`` )_-RRB- #_# type_NN 12_CD is_VBZ empty_JJ slide_NN ,_, 8_CD is_VBZ chart_NN ,_, 2_CD is_VBZ title+enumeration_NN Proceedings_NNS of_IN DSC_NNP 2003_CD 12_CD slide_NN <_NN -_: comInvoke(slides_NNS ,"Add"_JJ ,2,1_CD )_-RRB- #_# set_VBN the_DT title_NN of_IN the_DT slide_NN title_NN <_JJ -_: comGetProperty(_JJ comGetProperty(slide_NN ,_, "_`` Shapes_NNS "_'' )_-RRB- ,"Title_JJ "_'' )_-RRB- rng_JJ <_JJ -_: comGetProperty(_JJ comGetProperty(title_NN ,"TextFrame_NN "_'' )_-RRB- ,_, "_`` TextRange_JJ "_'' )_-RRB- comSetProperty(_JJ rng_NN ,"Text"_IN ,"Roulette_NNP :_: Chi_NNP Squared-Test_NNP "_'' )_-RRB- #_# add_VB analysis_NN results_NNS to_TO slide_VB enumshape_NN <_NNS -_: comInvoke(_JJ comGetProperty(slide_NN ,_, "_`` Shapes_NNS "_'' )_-RRB- ,_, "Item"_JJ ,2_NN )_-RRB- rng_NN <_NNS -_: comGetProperty(_JJ comGetProperty(enumshape_NN ,"TextFrame_NN "_'' )_-RRB- ,_, "_`` TextRange_JJ "_'' )_-RRB- txt_VB <_JJ -_: paste(_VBD n_RB ,rep(_VB "observations\tp_DT ="_NN ,length(_JJ probs_NNS )_-RRB- )_-RRB- ,probs_VBZ ,_, collapse_VB =_SYM "_`` \r"_NNS )_-RRB- comSetProperty(_NN rng_NN ,"Text"_JJ ,txt_NN )_-RRB- comSetProperty(_NN comGetProperty(_NN rng_NN ,_, "Font_JJ "_`` )_-RRB- ,_, "Size"_JJ ,16_NNS )_-RRB- #_# show_VB the_DT results_NNS comSetProperty(ppt_NN ,_, "Visible"_NNP ,TRUE)_NNP comInvoke(_NN comGetProperty(_NN pres_NNS ,_, "SlideShowSettings_NNS "_`` )_-RRB- ,_, "Run_JJ "_'' )_-RRB- }_JJ And_CC of_IN course_NN ,_, this_DT reporting_NN function_NN has_VBZ to_TO be_VB specified_VBN when_WRB creating_VBG the_DT menu_NN items_NNS ,_, e.g_NN ._. ..._: winMenuAddItem_IN ("_NNP Chi-Squared_NNP Test"_NNP ,_, "alpha_NNP =_SYM 0.75"_CD ,_, "doTest(0.75_CD ,\"ppointReport_NN \"_JJ )"_NN )_-RRB- ..._: This_DT provides_VBZ a_DT very_RB simple_JJ data_NNS reporting_VBG facility_NN ._. The_DT user_NN chooses_VBZ a_DT menu_NN item_NN in_IN the_DT R_NN application_NN window_NN ,_, R_NN gets_VBZ the_DT data_NNS from_IN Excel_NNP ,_, computes_VBZ the_DT results_NNS and_CC puts_VBZ the_DT report_NN into_IN PowerPoint_NNP ._. After_IN the_DT results_NNS have_VBP been_VBN shown_VBN ,_, you_PRP can_MD simply_RB save_VB the_DT resulting_VBG presentation_NN to_TO disk_NN for_IN later_RB use_NN ._. 4_CD Conclusion_NNP and_CC outlook_NN In_IN addition_NN to_TO embedding_VBG an_DT invisible_JJ R_NN into_IN a_DT spreadsheet_NN application_NN ,_, it_PRP is_VBZ also_RB possible_JJ to_TO run_VB R_NN in_IN parallel_JJ to_TO the_DT spreadsheet_NN ,_, providing_VBG access_NN to_TO the_DT R_NN command_NN line_NN at_IN the_DT same_JJ time_NN as_IN to_TO the_DT spreadsheet_NN interface_NN ._. This_DT allows_VBZ to_TO use_VB the_DT strengths_NNS of_IN both_DT office_NN applications_NNS and_CC R_NN side_NN by_IN side_NN on_IN the_DT Windows_NNP platform_NN ._. Currently_RB packages_NNS for_IN accessing_VBG office_NN applications_NNS are_VBP still_RB in_IN development_NN ._. ROffice_NN .Excel_NN is_VBZ available_JJ as_IN a_DT first_JJ implementation_NN from_IN the_DT R_NN COM_NNP home_NN page_NN http_VBD ://sunsite_JJ .univie_NN .ac.at/rcom_NN ._. There_EX is_VBZ also_RB a_DT mailing_NN list_NN available_JJ for_IN discussions_NNS on_IN the_DT current_JJ and_CC future_JJ implementations_NNS ._. Proceedings_NNS of_IN DSC_NNP 2003_CD 13_CD References_NNS Thomas_NNP Baier_NNP ._. R:_NNP Windows_NNP component_NN services_NNS ._. integrating_NN R_NN and_CC Excel_NNP on_IN the_DT COM_NNP layer_NN ._. In_IN Kurt_NNP Hornik_NNP and_CC Friedrich_NNP Leisch_NNP ,_, editors_NNS ,_, DSC_NNP 2003_CD Pro-_NNP ceedings_NNS of_IN the_DT 3rd_JJ International_NNP Workshop_NNP on_IN Distributed_NNP Statistical_NNP Comput-_NNP ing_NN ,_, 2003_CD ._. URL_NNP http_VBD ://www.ci.tuwien_JJ .ac.at/Conferences/DSC-2003/_JJ ._. ISSN_NNP :_: 1609-395X_JJ ._. Thomas_NNP Baier_NNP and_CC Erich_NNP Neuwirth_NNP ._. Embedding_NNP R_NN in_IN standard_JJ software_NN ,_, and_CC the_DT other_JJ way_NN round_NN ._. In_IN Kurt_NNP Hornik_NNP and_CC Friedrich_NNP Leisch_NNP ,_, editors_NNS ,_, DSC_NNP 2001_CD Pro-_NNP ceedings_NNS of_IN the_DT 2nd_NNP International_NNP Workshop_NNP on_IN Distributed_NNP Statistical_NNP Comput-_NNP ing_NN ,_, 2001_CD ._. URL_NNP http_VBD ://www.ci.tuwien_JJ .ac.at/Conferences/DSC-2001/_JJ ._. ISSN_NNP :_: 1609-395X_JJ ._. Dan_NNP Bricklin_NNP ._. Visicalc_NNP material_NN ,_, 1979_CD ._. URL_NNP http_VBD ://www.bricklin.com/visicalc_NNP ._. htm_'' ._. Gordon_NNP Filby_NNP ,_, editor_NN ._. Spreadsheets_NNPS in_IN Science_NNP and_CC Engineering_NNP ._. Springer_NNP Verlag_NNP ,_, 1997_CD ._. ISBN_NNP :_: 3-540-61253-X._DT GNOME_NNP Foundation_NNP ._. Gnumeric_NNP documentation_NN ,_, 2003_CD ._. URL_NNP http_VBD ://www.gnome_NN ._. org/projects/gnumeric_NN ._. Ross_NNP Ihaka_NNP and_CC Robert_NNP Gentleman_NNP ._. R:_'' A_DT language_NN for_IN data_NNS analysis_NN and_CC graphics_NNS ._. Journal_NNP of_IN Computational_NNP and_CC Graphical_NNP Statistics_NNPS ,_, 5(_JJ 3_CD )_-RRB- :299–314_CD ,_, 1996_CD ._. Microsoft_NNP Corporation_NNP ._. Microsoft_NNP Excel_NNP ._. Microsoft_NNP Corporation_NNP ,_, 1999_CD ._. Microsoft_NNP Corporation_NNP ._. Online_NNP resources_NNS ._. In_IN Microsoft_NNP Visual_NNP Basic_NNP for_IN Appli-_NNP cations_NNS ._. Microsoft_NNP Corporation_NNP ,_, 2002_CD ._. URL_NNP http_VBD ://msdn.microsoft.com/vba/_VBN technical/online_NN .asp._. Erich_NNP Neuwirth_NNP ._. Spreadsheets_NNS as_IN tools_NNS in_IN mathematical_JJ modeling_NN and_CC numerical_JJ mathematics_NNS ._. In_IN Gordon_NNP Filby_NNP ,_, editor_NN ,_, Spreadsheets_NNP in_IN Science_NNP and_CC Engineering_NNP ,_, pages_NNS 87–114_CD ._. Springer_NNP Verlag_NNP ,_, 1997_CD ._. ISBN_NNP :_: 3-540-61253-X._JJ Erich_NNP Neuwirth_NNP ._. Spreadsheets_NNS as_IN tools_NNS for_IN statistical_JJ computing_NN and_CC statistics_NNS educa_VBD -_: tion_NN ._. In_IN Jelke_NNP G._NNP Bethlehem_NNP and_CC Peter_NNP G._NNP M._NNP Van_NNP Der_NNP Heijden_NNP ,_, editors_NNS ,_, Compstat_NNP ,_, Proceedings_NNP in_IN Computational_NNP Statistics_NNPS ,_, 2000_CD ._. OpenCalc_NNP Technical_NNP Team_NNP ._. OpenCalc_NNP documentation_NN ,_, 2003_CD ._. URL_NNP http_VBD ://sc_NNP ._. openoffice_NN .org_NN ._. Proceedings_NNS of_IN DSC_NNP 2003_CD 14_CD Affiliation_NNP Thomas_NNP Baier_NNP Department_NNP of_IN Statistics_NNPS Vienna_NNP University_NNP of_IN Technology_NNP E-mail_NN :_: baier@ci.tuwien_NN .ac.at_IN Erich_NNP Neuwirth_NNP Department_NNP of_IN Statistics_NNPS and_CC Decision_NNP Support_NNP Systems_NNP University_NNP of_IN Vienna_NNP E-mail_NN :_: erich_JJ .neuwirth@univie_NN .ac.at_IN Introduction_NNP Excel_NNP as_IN the_DT host_NN R_NN as_IN the_DT host_NN Accessing_VBG Excel_NNP ,_, PowerPoint_NNP and_CC Word_NNP Controlling_NNP Excel_NNP :_: ROffice_NNP .Excel_NNP Excel_NNP R_NN PowerPoint_NN Conclusion_NNP and_CC outlook_NN
